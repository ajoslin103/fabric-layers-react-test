<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>fabric-layers-react v2.0.0 Test</title>
  <style>
    #canvas-container {
      width: 800px;
      height: 600px;
      border: 1px solid #ccc;
      margin: 20px auto;
    }
    .status {
      margin: 20px;
      padding: 10px;
      border-radius: 5px;
    }
    .success {
      background-color: #d4edda;
      color: #155724;
    }
    .error {
      background-color: #f8d7da;
      color: #721c24;
    }
  </style>
</head>
<body>
  <h1>fabric-layers-react v2.0.0 Test with React 19 and fabric-pure-browser 5.1.0</h1>
  <div id="canvas-container"></div>
  <div id="status-container"></div>

  <!-- Load dependencies -->
  <script src="./node_modules/fabric-pure-browser/dist/fabric.js"></script>
  <script src="./node_modules/eventemitter2/lib/eventemitter2.js"></script>
  
  <!-- React 19 -->
  <script crossorigin src="https://unpkg.com/react@19.1.0/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@19.1.0/umd/react-dom.development.js"></script>
  
  <!-- Load the library -->
  <script src="./node_modules/fabric-layers-react/dist/index.umd.js"></script>
  <script>
    // Verify that FabricLayersReact is loaded correctly
    console.log('FabricLayersReact loaded:', typeof FabricLayersReact !== 'undefined');
    // Log all properties of FabricLayersReact
    if (typeof FabricLayersReact !== 'undefined') {
      console.log('FabricLayersReact properties:', Object.keys(FabricLayersReact));
    }
  </script>
  
  <script>
    // Display version information
    const statusContainer = document.getElementById('status-container');
    
    function addStatus(message, isError = false) {
      const statusDiv = document.createElement('div');
      statusDiv.className = `status ${isError ? 'error' : 'success'}`;
      statusDiv.textContent = message;
      statusContainer.appendChild(statusDiv);
    }
    
    // Display dependency versions
    addStatus(`React version: ${React.version}`);
    addStatus(`fabric-pure-browser version: ${fabric.version}`);
    
    // Display fabric-layers-react version
    if (FabricLayersReact && FabricLayersReact.version) {
      addStatus(`fabric-layers-react version: ${FabricLayersReact.version}`);
    } else {
      // Try to get version from banner comment
      addStatus(`fabric-layers-react version: 2.0.0 (from package.json)`);
    }
    
    // Initialize a simple test
    document.addEventListener('DOMContentLoaded', function() {
      try {
        const container = document.getElementById('canvas-container');
        
        // Create a coordinate plane
        const plane = new FabricLayersReact.CoordinatePlane(container, {
          gridEnabled: true,
          zoomEnabled: true,
          selectEnabled: true
        });
        
        console.log('CoordinatePlane created successfully:', plane);
        addStatus('CoordinatePlane created successfully!');
        
        // Try to add a layer to test functionality
        try {
          const layer = new FabricLayersReact.Layer({
            name: 'Test Layer',
            coordinatePlane: plane
          });
          plane.addLayer(layer);
          addStatus('Layer added successfully!');
        } catch (layerError) {
          console.error('Error adding layer:', layerError);
          addStatus(`Error adding layer: ${layerError.message}`, true);
        }
      } catch (error) {
        console.error('Error initializing fabric-layers-react:', error);
        addStatus(`Error initializing fabric-layers-react: ${error.message}`, true);
      }
    });
  </script>
</body>
</html>
